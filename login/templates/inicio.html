
{% extends "base.html" %}
{% block titulo %}Inicio{% endblock %}
{% block contenido %}
    <!-- Barra de navegación -->
    <div class="barra-lateral" id="barra-lateral">
        <div class="contenedor-barra-lateral" id="contenedor-barra-lateral">
            <img src="/imagenes/usuario.png" alt="Logo de usuario" class="imagen-usuario">    
            <p class="texto-usuario" id="texto-usuario">{{ user.user }}<br><br>Administrador</p>    
            <hr class="linea-decorativa">                
            
            <!-- Menú de navegación en la barra lateral -->
            <ul class="menu-lateral">
                <!-- Enlaces a diferentes secciones del sistema -->
                <li><a href="{% url 'categoria' %}" class="menu-opcion">Crear categoria</a></li>
                <li><a href="{% url 'tikcet' %}" class="menu-opcion">Crear Ticket</a></li>
                <li><a href="#" class="menu-opcion" id="mostrar-todos">Mostrar Todos</a></li>
                <li><a href="#" class="menu-opcion" id="tickets-en-progreso">Tickets en Progreso</a></li>
                
            </ul>
        </div>
    </div>

    <!-- Contenedor principal que muestra el contenido de los tickets -->
    <div class="contenedor-principal" id="contenedor-principal"> 
        <!-- Contenedor principal con los tickets -->
        <main class="main-principal" id="main-principal">
            <!-- Campo de búsqueda para encontrar tickets -->
            <div class="contenedor-buscar">
                <input type="text" placeholder="Buscar ticket..." class="buscar-ticket"><br>
            </div>

            <!-- Cabecera principal con el título del sistema -->
            <header id="header" class="header">
                <h1>Sistema de tickets</h1>
                <br>
                <!-- Información del usuario logueado -->
                <div class="informacion-usuario">
                    <span>Usuario: <strong>{{ user.username }}</strong></span>
                </div>
            </header>

            <!-- Tabla que muestra los tickets -->
            <section class="tabla-tickets">
                <table>
                    <thead>
                        <tr>
                            <th>Encargado</th>
                            <th>ID Ticket</th>
                            <th>Problema</th>
                            <th>Descripción</th>
                            <th>Estado</th>
                            <th>Fecha de Creación</th>
                            <th>Fecha de Finalización</th>
                            <th>Resuelto</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for ticket in tickets %}
                            <tr>
                                <td>{{ ticket.usuario.username }}</td>
                                <td>{{ ticket.id }}</td>
                                <td>{{ ticket.titulo }}</td>
                                <td>{{ ticket.descripcion }}</td>
                                <td>{{ ticket.get_estado_display }}</td>
                                <td>{{ ticket.fecha_creacion }}</td>
                                <td>{{ ticket.fecha_resolucion }}</td>
                                <td>{{ ticket.get_estado_display }}</td>
                                <td>
                                    <a href="{% url 'edit_ticket' ticket.id %}" class="btn btn-primary">Editar</a>
                                    <form action="{% url 'delete_ticket' ticket.id %}" method="post" style="display:inline;">
                                        {% csrf_token %}
                                        <button type="submit" class="btn btn-danger">Eliminar</button>
                                    </form>
                                </td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td colspan="9">No hay tickets disponibles.</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                    
                </table>
            </section>
        </main>
    </div>
    {% endblock %}